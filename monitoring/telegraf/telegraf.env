# Telegraf Environment Configuration
# Azure Scheduled Events Monitoring for Grafana Labs

# Basic Environment Settings
ENVIRONMENT=production
HOSTNAME=${HOSTNAME:-$(hostname)}

# Grafana Cloud Prometheus Configuration
# Replace with your actual Grafana Cloud credentials and endpoints
PROMETHEUS_REMOTE_WRITE_URL=https://prometheus-prod-13-prod-us-east-0.grafana.net/api/prom/push
PROMETHEUS_USERNAME=123456  # Your Grafana Cloud instance ID
PROMETHEUS_PASSWORD=glc_your_grafana_cloud_api_key_here

# Azure Configuration
# Following Microsoft IMDS best practices and rate limiting guidelines
AZURE_SUBSCRIPTION_ID=your_subscription_id_here
AZURE_RESOURCE_GROUP=your_resource_group_here

# IMDS Rate Limiting Configuration (Microsoft Recommendations)
# Microsoft recommends max 5 requests per second to IMDS
# These intervals ensure compliance with rate limits
SCHEDULED_EVENTS_INTERVAL=30s  # Max ~2 requests/min for scheduled events
VM_METADATA_INTERVAL=300s      # Max ~12 requests/hour for metadata
HEALTH_CHECK_INTERVAL=60s      # Max ~1 request/min for health checks

# API Version Configuration
# Using latest stable API version as recommended by Microsoft
IMDS_API_VERSION=2021-12-13

# Security Configuration
# Following Microsoft guidelines for IMDS security
EXCLUDE_SENSITIVE_DATA=true    # Exclude sensitive fields from collection
DATA_SANITIZATION=true         # Enable data sanitization in processors
USE_MINIMAL_ENDPOINTS=true     # Use minimal IMDS endpoints where possible

# Telegraf Agent Configuration
TELEGRAF_CONFIG_PATH=/etc/telegraf/telegraf.conf
TELEGRAF_LOG_LEVEL=info
TELEGRAF_LOG_FILE=/var/log/telegraf/telegraf.log

# Custom Labels/Tags
CUSTOM_TEAM_LABEL=infrastructure
CUSTOM_PROJECT_LABEL=azure-monitoring

# Metric Collection Intervals (IMDS Rate Limit Compliant)
SCHEDULED_EVENTS_INTERVAL=30s  # Complies with Microsoft rate limits
VM_METADATA_INTERVAL=300s      # Reduced frequency for metadata
HEALTH_CHECK_INTERVAL=60s      # Balanced health monitoring

# Alert Thresholds (used by processors)
# Based on Microsoft Azure documentation event priorities
CRITICAL_EVENT_TYPES="Freeze,Preempt"       # Immediate impact events
HIGH_SEVERITY_EVENT_TYPES="Reboot,Redeploy" # Planned maintenance events

# Data Privacy and Security
# Following Microsoft IMDS security best practices
SENSITIVE_FIELDS_EXCLUDED="customData,userData,publicKeys,resourceId,subscriptionId,vmId"
MAX_DESCRIPTION_LENGTH=200     # Limit description field length
ENABLE_DATA_SANITIZATION=true  # Remove sensitive data from metrics

# Network Configuration
HTTP_TIMEOUT=5s
PROMETHEUS_LISTEN_PORT=9273

# Debugging (set to true for verbose logging)
DEBUG_MODE=false
ENABLE_FILE_OUTPUT=false

# Backup Prometheus endpoint (optional)
# BACKUP_PROMETHEUS_URL=http://localhost:9090/api/v1/write